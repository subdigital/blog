--- 
layout: post
title: On to a new client
date: 2007-2-28
comments: true
link: false
---
<p>I wrapped up my project at a client today, so I&rsquo;m on to a new one on Monday.</p><p>The project consisted mainly of SharePoint, but I did get to do some interesting development aside from that.&nbsp; I worked on a Stock Quote web service that would gather information from pluggable sources.&nbsp; They wanted to pay for a dedicated source, however politics and paperwork were such a barrier I ended up just scraping Google finance.&nbsp; It won&rsquo;t last forever, but it&rsquo;s free and avoids the paperwork.</p><p>We wrote a few custom SharePoint Web Parts, and I found out first hand what a pain in the ass it is to deploy these things.&nbsp; The deployment project outputs a CAB file.&nbsp; This CAB file needs to be copied onto the server, and you have to use the STSADM tool to install it into the portal server.&nbsp; This means you need Remote Desktop access just to deploy to&nbsp;a server!&nbsp; Our production servers are load-balanced, so this means you have to do it twice.&nbsp; To save us a lot of time and headaches I wrote a Windows service that would monitor a CAB file for changes using a FileSystemWatcher, when it detected a change, it would&hellip;</p><ul><li>Extract the CAB to get the dlls</li><li>Copy the dlls to the target bin folder</li><li>Optionally sign the assembly so it can be installed into the GAC</li><li>Run STSADM to remove the old CAB file from the portal server</li><li>Run STSADM to get the new CAB file in the portal&nbsp;server</li><li>Reset IIS</li></ul><p>This thing worked like a charm!&nbsp; We could kick off a build, run a batch file the copy the new CAB over, and the thing would install itself.&nbsp; I wish I could release the code here, but I wrote it at a client site, so it belongs to them.</p><p>We also managed to contort a SharePoint Portal site into something actually pleasing to look at, and ripped out most of SharePoints crappy markup.&nbsp; Why in the world does SharePoint output so many damn tables?</p><p>To be clear, this is all with SharePoint 2003, so I imagine MOSS 2007 is loads better, but I haven&rsquo;t yet worked on it.&nbsp; Anyway, my next project doesn&rsquo;t involve SharePoint, so I&rsquo;m happy.</p>
