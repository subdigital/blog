--- 
layout: post
title: Dear VSTS Test:I Hate You
date: 2007-8-6
comments: true
link: false
---
<p>I cannot even count the ways that VSTS Test is inferior to NUnit (or MbUnit).</p><p>I&rsquo;ve been running my tests via TestDriven.NET (right-click, Run Test) and it has been working just fine.&nbsp; The tests run, I get my results.&nbsp; The reason I do this is because the built-in test runner <strike>sucks</strike> leaves something to be desired.</p><p>I went to a teammates machine the other day and he ran the test suite and most of the tests failed.&nbsp; In fact, any test that hit the database failed.&nbsp; All of them had the same error message:&nbsp; </p><p><em><strong>ConfigurationException:&nbsp; Could not load the&nbsp;configSource &lsquo;local-connectionStrings.config&rsquo;</strong>.</em></p><p>This file is copied (via pre-build event) from a root location, to the output directory.&nbsp; This file is, by nature, different for each developer.&nbsp; It contains connection strings that are specific to the machine.</p><p>Using FileMon I was able to see that the VSTS Test Runner was looking in the <strong>..\..\TestResults\{TIMESTAMP FOLDER HERE}\Out\</strong> directory.&nbsp; The VSTS product team claims that this is for remote running of tests, but I suspect that it is just a poor solution to the problem.&nbsp; Anyway, there is no way that I can (via a batch file) copy the config file to this folder.&nbsp; So Pre-Build events are out.</p><p>I read up on the issue and find that it is possible to have items copied to the Test Results folder.&nbsp; You have to add this attribute to a test method:</p><p><strong>[DeployItem(&ldquo;local-connectionStrings.config&rdquo;)]</strong></p><p>&hellip;and yes, I said to a <em>test method</em>.&nbsp; It will not work on a [TestInitialize] or [TestClass].&nbsp; So basically if I want to use this feature, I have to retro fit around 80 tests to include this attribute, then tell my whole team to do it as well.&nbsp; No thank you.</p><p>You can also add the Deployment Item to the localtestrun.testrunconfig file (under Solution Items).&nbsp; This file says &ldquo;local&rdquo; but it is checked into source control, so it is not clear if this change will be applied to everyone&rsquo;s working copy or my own.</p><p>This is a stupid, hacky solution to a problem that doesn&rsquo;t even exist with the other unit test frameworks.&nbsp; Since we aren&rsquo;t really using any TFS test features yet (Web Tests will come) &mdash;I&rsquo;m tempted to just rewrite them all for NUnit.&nbsp; Of course I will get pushback from management, but these little issues are becoming a hinderance.&nbsp; </p><p><strong>If it is cumbersome to test, developers won&rsquo;t write unit tests.</strong></p><p>(Oh, and <a href="http://www.jetbrains.com/">JetBrains</a>:&nbsp; when will you release support for the VSTS Tests?&nbsp; I&rsquo;m dying over here!)</p><div class="bjtags">Tags:<a rel="tag" href="http://technorati.com/tag/VSTS">VSTS</a>, <a rel="tag" href="http://technorati.com/tag/Unit+Test">Unit+Test</a></div>
