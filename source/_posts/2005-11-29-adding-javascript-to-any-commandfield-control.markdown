--- 
layout: post
title: Adding Javascript to ANY CommandField control
date: "2005-11-29"
comments: true
link: false
---
<p>In the previous post, I mentioned how annoying it is to have to treat an ImageButton separate from a Button and separate from a LinkButton when they are all essentially the same thing.</p><p>The answer here lies in the IButtonControl interface, (whose name strongly suggests that it should be a direct parent, not an interface, but oh well)&hellip;</p><p>Here&rsquo;s how you&rsquo;d add javascript and tool tips to those&nbsp;CommandField&nbsp;button controls, without having to write specific versions for all three:</p><div style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 0pt; BORDER-TOP: windowtext 1pt solid; PADDING-LEFT: 0pt; FONT-SIZE: 9pt; BACKGROUND: white; PADDING-BOTTOM: 0pt; BORDER-LEFT: windowtext 1pt solid; COLOR: black; PADDING-TOP: 0pt; BORDER-BOTTOM: windowtext 1pt solid; FONT-FAMILY: Courier New"><p style="MARGIN: 0px"><span style="COLOR: teal">&nbsp;&nbsp;&nbsp;&nbsp;1</span>&nbsp;<span style="COLOR: blue">protected</span> <span style="COLOR: blue">void</span> gvCrews_RowDataBound(<span style="COLOR: blue">object</span> sender, GridViewRowEventArgs e)</p><p style="MARGIN: 0px"><span style="COLOR: teal">&nbsp;&nbsp;&nbsp;&nbsp;2</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p><p style="MARGIN: 0px"><span style="COLOR: teal">&nbsp;&nbsp;&nbsp;&nbsp;3</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="COLOR: green">//grab last column (the command column)</span></p><p style="MARGIN: 0px"><span style="COLOR: teal">&nbsp;&nbsp;&nbsp;&nbsp;4</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="COLOR: blue">int</span> cmdCol = gvCrews.Columns.Count - 1;</p><p style="MARGIN: 0px"><span style="COLOR: teal">&nbsp;&nbsp;&nbsp;&nbsp;5</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="COLOR: blue">foreach</span> (Control ctrl <span style="COLOR: blue">in</span> e.Row.Cells[cmdCol].Controls)</p><p style="MARGIN: 0px"><span style="COLOR: teal">&nbsp;&nbsp;&nbsp;&nbsp;6</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </p><p style="MARGIN: 0px"><span style="COLOR: teal">&nbsp;&nbsp;&nbsp;&nbsp;7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p><p style="MARGIN: 0px"><span style="COLOR: teal">&nbsp;&nbsp;&nbsp;&nbsp;8</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; IButtonControl btn = ctrl <span style="COLOR: blue">as</span> IButtonControl;</p><p style="MARGIN: 0px"><span style="COLOR: teal">&nbsp;&nbsp;&nbsp;&nbsp;9</span>&nbsp;</p><p style="MARGIN: 0px"><span style="COLOR: teal">&nbsp;&nbsp;&nbsp;10</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="COLOR: blue">if</span> (btn != <span style="COLOR: blue">null</span>) </p><p style="MARGIN: 0px"><span style="COLOR: teal">&nbsp;&nbsp;&nbsp;11</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </p><p style="MARGIN: 0px"><span style="COLOR: teal">&nbsp;&nbsp;&nbsp;12</span>&nbsp;</p><p style="MARGIN: 0px"><span style="COLOR: teal">&nbsp;&nbsp;&nbsp;13</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="COLOR: blue">if</span> (btn.CommandName == "Delete")</p><p style="MARGIN: 0px"><span style="COLOR: teal">&nbsp;&nbsp;&nbsp;14</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p><p style="MARGIN: 0px"><span style="COLOR: teal">&nbsp;&nbsp;&nbsp;15</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ((WebControl)ctrl).Attributes.Add("onClick", "return confirm('Are you sure you want to delete the crew and its ENTIRE history?&nbsp; This cannot be undone...');");</p><p style="MARGIN: 0px"><span style="COLOR: teal">&nbsp;&nbsp;&nbsp;16</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ((WebControl)ctrl).ToolTip = "Click here to delete";</p><p style="MARGIN: 0px"><span style="COLOR: teal">&nbsp;&nbsp;&nbsp;17</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p><p style="MARGIN: 0px"><span style="COLOR: teal">&nbsp;&nbsp;&nbsp;18</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="COLOR: blue">else</span> <span style="COLOR: blue">if</span> (btn.CommandName == "Edit")</p><p style="MARGIN: 0px"><span style="COLOR: teal">&nbsp;&nbsp;&nbsp;19</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</p><p style="MARGIN: 0px"><span style="COLOR: teal">&nbsp;&nbsp;&nbsp;20</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ((WebControl)ctrl).ToolTip = "Click here to edit";</p><p style="MARGIN: 0px"><span style="COLOR: teal">&nbsp;&nbsp;&nbsp;21</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p><p style="MARGIN: 0px"><span style="COLOR: teal">&nbsp;&nbsp;&nbsp;22</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </p><p style="MARGIN: 0px"><span style="COLOR: teal">&nbsp;&nbsp;&nbsp;23</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp; </p><p style="MARGIN: 0px"><span style="COLOR: teal">&nbsp;&nbsp;&nbsp;24</span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p></div><p><!--EndFragment-->&nbsp;This way I can still change the look &amp; feel of the GridView CommandField and I don&rsquo;t have to recompile to support it.&nbsp; Unfortunately the IButtonInterface doesn&rsquo;t allow for javascript attributes or tooltips, so I have to cast the control as a WebControl to add those in.&nbsp; Setting <em>CausesValidation=true</em> still causes an exception for the ImageButton though, so I haven&rsquo;t figured out a way around this yet.</p><p><strong>Now playing:</strong> <a href="http://phobos.apple.com/WebObjects/MZSearch.woa/wa/advancedSearchResults?artistTerm=Nine Inch Nails">Nine Inch Nails</a> - <a href="http://phobos.apple.com/WebObjects/MZSearch.woa/wa/advancedSearchResults?songTerm=The Hand That Feeds&amp;artistTerm=Nine Inch Nails">The Hand That Feeds</a></p>
