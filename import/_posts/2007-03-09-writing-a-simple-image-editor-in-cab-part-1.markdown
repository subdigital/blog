--- 
layout: post
title: Writing a Simple Image Editor in CAB - Part 1
date: 2007-3-9
comments: true
link: false
---
<p>I promised posts with more &ldquo;meat,&rdquo; so here it goes.&nbsp; I&rsquo;m going to demonstrate how to start writing a CAB application by building a simple image manipulation program.</p><p><u>Overview:<br /></u><em>The application will load an image from some flexible source (file system, flickr, whatever).&nbsp; The image will be displayed on the canvas.&nbsp; The user will have various filters to apply to the image.&nbsp; These filters should be easily added later on, and they should all manipulate the image in some way.&nbsp; When everything is done, the user will have the option of saving the changes to disk.</em></p><p>So now that we have our high-level description of the app, let&rsquo;s build it!</p><p>Start up Visual Studio 2005, create a blank solution called <strong>CAB-ImageEditor</strong>.&nbsp; Add a new C# Windows application called <strong>ImageEditorShell</strong>.&nbsp; This will be the basic structure of the application, and we will add things to it.</p><p>Add the following references to your project:</p><ul><li>Microsoft.Practices.CompositeUI</li><li>Microsoft.Practices.ObjectBuilder</li><li>Microsoft.Practices.CompositeUI.WinForms</li></ul><p>First you need to delete the files&nbsp;that Visual Studio gives you out of the box.&nbsp; We will start from scratch.</p><p>Create a new Form called <strong>ImageEditorShell.cs</strong>.&nbsp; Give it a window title if you like.</p><p><img src="/images/CropperCapture%5B41%5D_small.jpg" alt="Our blank shell"  border="1"  /></p><p>Create a new class called <strong>ImageEditorApplication.cs</strong>.&nbsp; This will be the entry point for our application.&nbsp; We need to inherit the class from <strong>FormShellApplication&lt;T,K&gt;</strong> and give it the type of the root work item and our shell.</p><div style="FONT-SIZE: 8pt; BACKGROUND: white; COLOR: black; FONT-FAMILY: Consolas"><p style="MARGIN: 0px"><span style="COLOR: blue">using</span> System;</p><p style="MARGIN: 0px"><span style="COLOR: blue">using</span> Microsoft.Practices.CompositeUI;</p><p style="MARGIN: 0px"><span style="COLOR: blue">using</span> Microsoft.Practices.CompositeUI.WinForms;</p><p style="MARGIN: 0px">&nbsp;</p><p style="MARGIN: 0px"><span style="COLOR: blue">namespace</span> ImageEditorShell</p><p style="MARGIN: 0px">{</p><p style="MARGIN: 0px">&nbsp; &nbsp; <span style="COLOR: blue">public</span> <span style="COLOR: blue">class</span> <span style="COLOR: teal">ImageEditorApplication</span> : <span style="COLOR: teal">FormShellApplication</span>&lt;<span style="COLOR: teal">WorkItem</span>, <span style="COLOR: teal">ImageEditorShell</span>&gt;</p><p style="MARGIN: 0px">&nbsp; &nbsp; {</p><p style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; }</p><p style="MARGIN: 0px">}</p></div><p>We need an entry point to start the application, so add that&hellip;</p><div style="FONT-SIZE: 8pt; BACKGROUND: white; COLOR: black; FONT-FAMILY: Consolas"><p style="MARGIN: 0px"><span style="COLOR: blue">public</span> <span style="COLOR: blue">class</span> <span style="COLOR: teal">ImageEditorApplication</span> : <span style="COLOR: teal">FormShellApplication</span>&lt;<span style="COLOR: teal">WorkItem</span>, <span style="COLOR: teal">ImageEditorShell</span>&gt;</p><p style="MARGIN: 0px">{</p><p style="MARGIN: 0px">&nbsp; &nbsp; <strong>[<span style="COLOR: teal">STAThread</span>]</strong></p><p style="MARGIN: 0px"><strong>&nbsp; &nbsp; <span style="COLOR: blue">public</span> <span style="COLOR: blue">static</span> <span style="COLOR: blue">void</span> Main()</strong></p><p style="MARGIN: 0px"><strong>&nbsp; &nbsp; {</strong></p><p style="MARGIN: 0px"><strong>&nbsp; &nbsp; &nbsp; &nbsp; <span style="COLOR: blue">new</span> <span style="COLOR: teal">ImageEditorApplication</span>().Run();</strong></p><p style="MARGIN: 0px"><strong>&nbsp; &nbsp; }</strong>&nbsp; &nbsp; &nbsp; &nbsp; </p><p style="MARGIN: 0px">}</p></div><p>That&rsquo;s all we need to get our application running.&nbsp; Go ahead and push F5 and see what happens.</p><p>Man, are you impressed yet?&nbsp; Hehe, chill out.&nbsp; There&rsquo;s more to come&hellip;</p>
