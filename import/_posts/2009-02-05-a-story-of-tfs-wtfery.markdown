--- 
layout: post
title: A Story of TFS WTFery
date: 2009-2-5
comments: true
link: false
---
<p>I've had it with TFS.&nbsp; It's a thorn in my side.&nbsp; It sits there, embedded in Visual studio like ivy on a brick wall, mocking me.&nbsp; It's like developing in a hot tar pit.&nbsp; Sticky, smelly, and literally the <strong>biggest source of developer pain I feel these days</strong>.&nbsp; I finished up a set of bug fixes and application features that I needed to deploy to QA today.&nbsp;&nbsp; <p>One of them was updating a text file.&nbsp; Easy, right?&nbsp; Just double click the file!&nbsp; WRONG.&nbsp; If you do this you can't save it, you need to open Visual Studio &amp; explicitly check-out the file.&nbsp; Then you can edit it.&nbsp; This is done because apparently the developers of TFS decided that Visual Studio is our only editor....  <p><strong>Don't lock my files, bro!</strong>  <p><a href="http://flux88.com/files/media/image/WindowsLiveWriter/AStoryofTFSWTFery_FA86/203-41266207d6209dc6_2.png"><img src="/images/203-41266207d6209dc6_thumb_.png" alt="203-41266207d6209dc6"  border="0" /></a>  <p>That is a minor gripe, but it's pretty substantial when you think about the fact that I have batch files, a NAnt build, configuration files, and a readme... all of which I'd like to use either <a href="http://www.flos-freeware.ch/notepad2.html">Notepad2</a> or <a href="http://e-texteditor.com">e-texteditor</a> to edit.  <p>If I want to edit a text file, Visual Studio is <strong>the last editor on the planet that I want to use</strong>.  <p>Then I finish up some other boring SSRS work and commit it to our dev branch.&nbsp; Our CI build shows success, and I'm ready to merge to integration, which is where we deploy from.&nbsp; I kick off the deploy process and it fails.&nbsp; Apparently there was a missing file in the integration branch.  <p>This file was a new file in a directory that was already branched, so when mergine shouldn't it get merged too?&nbsp; I guess not, because when I go to merge the folder, the new file is excluded.&nbsp; If you right click &amp; try to merge just the file, it shows no branching targets.&nbsp; Ok, so let's branch it.&nbsp;&nbsp; <p><a href="http://flux88.com/files/media/image/WindowsLiveWriter/AStoryofTFSWTFery_FA86/203-41266207ce9264e2_2.png"><img src="/images/203-41266207ce9264e2_thumb_.png" alt="203-41266207ce9264e2"  border="0" /></a>  <p>Branching in the same folder?&nbsp; Why on earth would you ever want to do that?&nbsp; That, my friends, is <strong>the path to madness</strong>.&nbsp; I correct the path to branch the file into the integration path.  <p>So I finally do my build again, and get more errors.&nbsp; Reading the build output it looks like some changes still haven't made it over.&nbsp; I do another merge on this folder and...  <p><a href="http://flux88.com/files/media/image/WindowsLiveWriter/AStoryofTFSWTFery_FA86/203-41266207d6c2f073_2.png"><img src="/images/203-41266207d6c2f073_thumb_.png" alt="203-41266207d6c2f073"  border="0" /></a>  <p>then do a diff of the files:  <p><a href="http://flux88.com/files/media/image/WindowsLiveWriter/AStoryofTFSWTFery_FA86/203-41266207d71aed6b_2.png"><img src="/images/203-41266207d71aed6b_thumb_.png" alt="203-41266207d71aed6b"  border="0" /></a>  <p>WTFF!  <p>So I guess now I'll need to merge each file, not the directory.&nbsp; Select the files and...  <p><a href="http://flux88.com/files/media/image/WindowsLiveWriter/AStoryofTFSWTFery_FA86/203-41266207d8308b91_2.png"><img src="/images/203-41266207d8308b91_thumb_.png" alt="203-41266207d8308b91"  border="0" /></a>  <p>Doh!&nbsp; You can't branch multiple files via selection like this.&nbsp; Why?&nbsp; I'm sure there's a technical reason, but <strong>I don't flippin care</strong>.&nbsp; This is an abismal user-experience.  <p>Ok, so I'll branch <em>each one</em> individually....&nbsp; Merging individually didn't work either:  <p><a href="http://flux88.com/files/media/image/WindowsLiveWriter/AStoryofTFSWTFery_FA86/203-41266207e0fbd402_2.png"><img src="/images/203-41266207e0fbd402_thumb_.png" alt="203-41266207e0fbd402"  border="0" /></a>  <p>At this point I'm feeling a little bit like this guy:  <p><a href="http://flux88.com/files/media/image/WindowsLiveWriter/AStoryofTFSWTFery_FA86/60371673_0eb0b14f91_2.jpg"><img src="/images/60371673_0eb0b14f91_thumb_.jpg" alt="60371673_0eb0b14f91"  border="0" /></a>  <p><em>(</em><a href="http://flickr.com/photos/dannyboyster"><em>http://flickr.com/photos/dannyboyster</em></a><em>)</em>  <p>So I went to the command-line to try a baseless merge.&nbsp; You can do that like this: {% codeblock %}c:\project&gt;tf merge /baseless &lt;source&gt; &lt;target&gt; /recursive {% endcodeblock %}
<p>This seemed to do the trick.&nbsp; Time to commit the changes.
<p>Now I'm greeted with a host of conflicts.&nbsp; I have <strong>never</strong> made code changes to my target branch.&nbsp; I have only merged to it.&nbsp; There should never be an incompatible change!
<p>Now, here's what really gets me:&nbsp; I get different conflict resolution <em>language</em> depending on if I select a single file or multiple files.
<p>Single file conflict resolution dialog:
<p><a href="http://flux88.com/files/media/image/WindowsLiveWriter/AStoryofTFSWTFery_FA86/203-41266207dfeac2f0_2.png"><img src="/images/203-41266207dfeac2f0_thumb_.png" alt="203-41266207dfeac2f0"  border="0" /></a>
<p>Multiple file conflict resolution dialog:
<p><a href="http://flux88.com/files/media/image/WindowsLiveWriter/AStoryofTFSWTFery_FA86/203-41266207dfcdf012_2.png"><img src="/images/203-41266207dfcdf012_thumb_.png" alt="203-41266207dfcdf012"  border="0" /></a>
<p>So which is it TFS?&nbsp; Source/Target, or Local/Server?&nbsp; This is so confusing I'm not sure what to do in the latter.&nbsp; I guess I need discard server version, so I do that.
<p>Two hours after completing my feature work, I'm finally able to check in the changes, do my deploy, and see it running successfully on the QA box.
<p>What a day.&nbsp; <strong>TFS:&nbsp; I hate you</strong>.</p>
