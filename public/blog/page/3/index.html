
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>
    
    Fickle Bits
  </title>
  <meta name="author" content="Ben Scheirman">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  

  <link rel="canonical" href="http://benscheirman.com/blog/page/3/index.html"/>
  <link href="/favicon.png" rel="shortcut icon" />
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="http://s3.amazonaws.com/ender-js/jeesh.min.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="http://feeds.feedburner.com/ficklebits" rel="alternate" title="Fickle Bits" type="application/atom+xml"/>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-210379-10']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


  
  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>


  
  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


  <!--Fonts from Google's Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>

</head>

<body  >
  <header><hgroup>
  <h1><a href="/">Fickle Bits</a></h1>
  
    <h2>You're doing it wrong.</h2>
  
</hgroup>

</header>
  <nav role=navigation><ul role=subscription data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/ficklebits" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="http://google.com/search" method="get">
  <fieldset role="site-search">
    <input type="hidden" name="q" value="site:benscheirman.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul role=main-navigation>
  <li><a href="/">Blog</a></li>
  <li><a href="/about-me">About Me</a></li>
  <li><a href="/speaking">Speaking</a></li>
  <li><a href="/contact">Contact</a></li>
  <li><a href="http://appsites.heroku.com/giggletouch">Giggle Touch for
    iOS</a></li>
  <li><a href="/blog/archives">Archives</a></li>

</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">



  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/2011/04/using-guard-spork-with-mongoid-devise/">Using Guard & Spork With Mongoid & Devise</a></h1>
    
    
      <p class="meta">




<time datetime="2011-04-22 00:00:00 -0500" pubdate  updated >Apr 22<span>nd</span>, 2011</time>


</p>
    
  </header>


  <div class="entry-content"><p>On my last project, I eventually settled on using Guard along with Spork to allow for quicker testing. Specifically, I used:</p>


<ul>
  <li>rspec</li>

  <li>spork</li>

  <li>rb-fsevent</li>

  <li>guard</li>

  <li>guard-rspec</li>

  <li>guard-pow</li>

  <li>guard-spork</li>
</ul>


<p>
You might be saying, <em>&#8220;What the hell are all these gems for?!?!&#8221;</em>
</p>




<h3>Guard</h3>


<p>This is a lot of development gem dependencies, but once working, it can vastly grease your testing workflow. <a href="https://github.com/guard/guard">Guard</a> is a framework for watching files &amp; doing something when they change. Make sure to use <a href="https://github.com/thibaudgg/rb-fsevent">rb-fsevent</a> as well to make detecting files not melt your machine polling for changes.</p>


<h3>Guard-rspec</h3>


<p><a href="https://github.com/guard/guard-rspec">guard-rspec</a> notices that models and/or specs change, and runs the related spec file automatically. Just running one test makes things faster, but you still have to reload all of rails with each run, making the feedback loop completely undesirable.</p>


<h3>Spork</h3>


<p>This is where <a href="https://github.com/timcharper/spork">Spork</a> comes in. Spork pre-loads your environment, allowing rspec files to run with &#8211;drb mode &amp; essentially caching your environment for multiple, fast test runs. That is, unless you change something in the environment (such as config/environment, routes.rb, or Gemile). These changes require spork to be restarted, which is SLOOOOW.</p>


<p>It&#8217;s not always obvious when spork needs reloading, so sometimes you&#8217;d find yourself scratching your head, saying, &#8220;this test should be failing&#8230; but it&#8217;s not!&#8221; Followed by a head-slap, when you realize you need to bounce spork.</p>


<h3>Guard-spork</h3>


<p>So <a href="https://github.com/guard/guard-spork">guard-spork</a> is a nice way of automatically detecting these changes and reloading spork for you.</p>


<h3>Guard-pow</h3>


<p>Lastly, I&#8217;m using <a href="http://pow.cx">pow</a> from 37signals, so any env related changes that require a server restart automatically call touch tmp/restart.txt and pow restarts the app. Guard-pow does this for you.</p>


<h2>Workflow</h2>


<p>It&#8217;s hard to say what all this means for the developer&#8217;s workflow, but basically all you need to do is run `guard` in a Terminal tab of its own and let it run. I run `guard` almost all day, and it generally does what I need it to.</p>


<p>Life is good, until you try to use this on another project that uses Mongoid &amp; Devise&#8230;</p>


<p>The Problem with Mongoid + Spork</p>


<p>Mongoid include its models with Rails, so that means if you change your models you have to reload rails. Not very friendly with a Spork-type model. Hopefully they&#8217;ll add a lifecycle hook in the future, but until they do, we can utilize a feature of Spork that can save the day: `trap_method/trap_class_method`.</p>


<p>The details are found <a href="https://github.com/timcharper/spork/wiki/Spork.trap_method-Jujutsu%20(found%20from%20http://ihswebdesign.com/blog/spork-not-reloading/)https://github.com/timcharper/spork/wiki/Spork.trap_method-Jujutsu%20(found%20from%20http://ihswebdesign.com/blog/spork-not-reloading/)https://github.com/timcharper/spork/wiki/Spork.trap_method-Jujutsu%20(found%20from%20http://ihswebdesign.com/blog/spork-not-reloading/">here</a>, but for the impatient, I modified my `spec_helper`&#8217;s prefork block to look like this:</p>




<div><figure role=code> <div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
<span class='line'>3</span>
<span class='line'>4</span>
<span class='line'>5</span>
<span class='line'>6</span>
<span class='line'>7</span>
<span class='line'>8</span>
</pre></td><td class='code' width='100%'><pre><code class='ruby'><div class='line'><span class="no">Spork</span><span class="o">.</span><span class="n">prefork</span> <span class="k">do</span><span class="o">&lt;</span><span class="n">br</span><span class="sr"> /&gt;  ENV[&quot;RAILS_ENV&quot;] ||= &#39;test&#39;&lt;br /</span><span class="o">&gt;&lt;</span><span class="n">br</span><span class="sr"> /&gt;</span>
</div><div class='line'><span class="sr">  require &#39;rails/mon</span><span class="n">goid</span><span class="s1">&#39;</span>
</div><div class='line'><span class="s1">  Spork.trap_class_method(Rails::Mongoid, :load_models)</span>
</div><div class='line'>
</div><div class='line'><span class="s1">  # Now load our environment</span>
</div><div class='line'><span class="s1">  require File.expand_path(&quot;../../config/environment&quot;, __FILE__)</span>
</div><div class='line'><span class="s1">  require &#39;</span><span class="n">rspec</span><span class="o">/</span><span class="n">rails</span><span class="err">&#39;</span>
</div><div class='line'>  <span class="o">.</span><span class="n">.</span><span class="o">.</span>
</div></code></pre></td></tr></table></div></figure></div>




<p>Basically this forces that call to be loaded later on in the lifecycle.</p>


<p>There&#8217;s a similar interception done for Device, which likes to load models along with Rails routes. You might also need to use this technique to deal with similar issues with Factory Girl, Machinist, and Shoulda Macros as well.</p>


<p>And now my specs are faster again. Yay!<br /></p>


<h2>Is the Complexity Worth it?</h2>


<p>Is this complexity worth it? <a href="http://twitter.com/garybernhardt">Some</a> would say no, and I&#8217;m certainly aware of how much additional &#8220;gem weight&#8221; this adds to a project.</p>


<p>For a great discussion about how to make your specs fast without requiring the complexity of Spork, check out the latest episode of Destroy All Software: <a href="https://www.destroyallsoftware.com/screencasts/catalog/fast-tests-with-and-without-rails">Fast Specs with and without Rails</a>. These screencasts are excellent..</p>

</div>
  <footer>
    <a rel="full-article" href="/2011/04/using-guard-spork-with-mongoid-devise/">Read on &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/2011/04/private-categories-in-objective-c/">Private Categories in Objective-C</a></h1>
    
    
      <p class="meta">




<time datetime="2011-04-16 00:00:00 -0500" pubdate  updated >Apr 16<span>th</span>, 2011</time>


</p>
    
  </header>


  <div class="entry-content"><p>Sometimes properties can vastly simplify the memory management code when working with your private instance variables (or <em>ivars</em>). Here is an example:</p>

<p><em>MyTableViewController.h</em></p>

<div><figure role=code> <div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
<span class='line'>3</span>
<span class='line'>4</span>
<span class='line'>5</span>
<span class='line'>6</span>
<span class='line'>7</span>
<span class='line'>8</span>
<span class='line'>9</span>
</pre></td><td class='code' width='100%'><pre><code class='objc'><div class='line'><span class="k">@interface</span> <span class="nc">MyTableViewController</span> : <span class="nc">UITableViewController</span> <span class="p">{</span>
</div><div class='line'>    <span class="n">NSArray</span> <span class="o">*</span><span class="n">items</span><span class="p">;</span>
</div><div class='line'><span class="p">}</span>
</div><div class='line'>
</div><div class='line'><span class="k">@property</span> <span class="p">(</span><span class="n">nonatomic</span><span class="p">,</span> <span class="n">retain</span><span class="p">)</span> <span class="n">NSArray</span> <span class="o">*</span><span class="n">items</span><span class="p">;</span>
</div><div class='line'>
</div><div class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">somethingChanged</span><span class="p">;</span>
</div><div class='line'>
</div><div class='line'><span class="k">@end</span>
</div></code></pre></td></tr></table></div></figure></div>


<p><em>MyTableViewController.m</em></p>

<div><figure role=code> <div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
<span class='line'>3</span>
<span class='line'>4</span>
<span class='line'>5</span>
<span class='line'>6</span>
<span class='line'>7</span>
<span class='line'>8</span>
<span class='line'>9</span>
<span class='line'>10</span>
<span class='line'>11</span>
<span class='line'>12</span>
<span class='line'>13</span>
<span class='line'>14</span>
<span class='line'>15</span>
<span class='line'>16</span>
<span class='line'>17</span>
<span class='line'>18</span>
<span class='line'>19</span>
<span class='line'>20</span>
<span class='line'>21</span>
</pre></td><td class='code' width='100%'><pre><code class='objc'><div class='line'><span class="k">@implementation</span> <span class="nc">MyTableViewController</span>
</div><div class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">viewDidLoad</span> <span class="p">{</span>
</div><div class='line'>    <span class="p">[</span><span class="n">super</span> <span class="n">viewDidLoad</span><span class="p">];</span>
</div><div class='line'>    <span class="c1">//using the ivar</span>
</div><div class='line'>    <span class="n">items</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSArray</span> <span class="nl">arrayWithObjects:</span><span class="s">@&quot;Item 1&quot;</span><span class="p">,</span> <span class="s">@&quot;Item 2&quot;</span><span class="p">,</span> <span class="nb">nil</span><span class="p">]</span> <span class="n">retain</span><span class="p">];</span>
</div><div class='line'>    <span class="c1">//using the property</span>
</div><div class='line'>    <span class="n">self</span><span class="p">.</span><span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSArray</span> <span class="nl">arrayWithObjects:</span><span class="s">@&quot;Item 1&quot;</span><span class="p">,</span> <span class="s">@&quot;Item 2&quot;</span><span class="p">,</span> <span class="nb">nil</span><span class="p">];}</span>
</div><div class='line'>
</div><div class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">somethingChanged</span> <span class="p">{</span>
</div><div class='line'>    <span class="c1">//using the ivar</span>
</div><div class='line'>    <span class="p">[</span><span class="n">items</span> <span class="n">release</span><span class="p">];</span>
</div><div class='line'>    <span class="n">items</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSArray</span> <span class="nl">arrayWithObjects:</span><span class="s">@&quot;New Item 1&quot;</span><span class="p">,</span> <span class="s">@&quot;New Item 2&quot;</span><span class="p">,</span> <span class="nb">nil</span><span class="p">]</span> <span class="n">retain</span><span class="p">];</span>
</div><div class='line'>    <span class="c1">//using the property</span>
</div><div class='line'>    <span class="n">self</span><span class="p">.</span><span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSArray</span> <span class="nl">arrayWithObjects:</span><span class="s">@&quot;New Item 1&quot;</span><span class="p">,</span> <span class="s">@&quot;New Item 2&quot;</span><span class="p">,</span> <span class="nb">nil</span><span class="p">];</span>
</div><div class='line'>    <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">tableView</span> <span class="n">reloadData</span><span class="p">];</span>
</div><div class='line'><span class="p">}</span>
</div><div class='line'>
</div><div class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">dealloc</span> <span class="p">{</span>
</div><div class='line'>    <span class="p">[</span><span class="n">items</span> <span class="n">release</span><span class="p">];</span>
</div><div class='line'>    <span class="p">[</span><span class="n">super</span> <span class="n">dealloc</span><span class="p">];</span>
</div><div class='line'><span class="p">}</span><span class="k">@end</span>
</div></code></pre></td></tr></table></div></figure></div>


<p>Notice that in each use of the ivar, we have to take special care to manage the memory properly. In the first case, we have to make sure to retain the value, because <code>[NSArray arrayWithObjects:]</code> returns an autoreleased instance. In the second case, we have to make sure and release the first array before assigning it to the second array.</p>

<p>The only questionable part of using properties is probably obvious: <strong>You have exposed your internal state to outside classes, but only for the benefit of your implentation.</strong> It seems odd to change your public API simply to make the implementation a bit cleaner. How can we fix this?</p>

<h2>Categories</h2>


<p>Before we solve the above problem, let&#8217;s take a slight detour and learn about categories. A category in Objective-C is similar to an extension method in .NET. You basically re-open the class, define a method (or many) and provide your implementation. The result is it appears as if those methods were part of the original class all along.</p>

<p>Here&#8217;s an example of putting a startsWith method on the string class:</p>

<p><em>NSString+FLUXAdditions.h</em></p>

<div><figure role=code> <div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
<span class='line'>3</span>
</pre></td><td class='code' width='100%'><pre><code class='objc'><div class='line'><span class="k">@interface</span> <span class="nc">NSString</span> <span class="nl">(FLUXAdditions)</span>
</div><div class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nl">startsWith:</span><span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="n">prefix</span><span class="p">;</span>
</div><div class='line'><span class="k">@end</span>
</div></code></pre></td></tr></table></div></figure></div>


<p><em>NSString+FLUXAdditions.m</em></p>

<div><figure role=code> <div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
<span class='line'>3</span>
<span class='line'>4</span>
<span class='line'>5</span>
</pre></td><td class='code' width='100%'><pre><code class='objc'><div class='line'><span class="k">@implementation</span> <span class="nc">NSString</span> <span class="nl">(FLUXAdditions)</span>
</div><div class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nl">startsWith:</span><span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="n">prefix</span> <span class="p">{</span>
</div><div class='line'><span class="k">return</span> <span class="p">[[</span><span class="n">self</span> <span class="nl">substringToIndex:</span><span class="p">[</span><span class="n">prefix</span> <span class="n">length</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="nl">isEqualTo:</span><span class="n">prefix</span><span class="p">];</span>
</div><div class='line'><span class="p">}</span>
</div><div class='line'><span class="k">@end</span>
</div></code></pre></td></tr></table></div></figure></div>


<p>[box type=&#8221;info&#8221;]Notice the naming of the filename &amp; the category name. Most people use the + syntax to denote a category on the class they&#8217;re adding on to. The prefix is also important. If you just name your category &#8220;Additions&#8221; then it&#8217;s possible that other libraries you include (or future versions of the SDK) could have the same name, leading to a collision. The common practice is to utilize a company prefix on classes that could be reused by others or that could cause collisions in the future.[/box]
Now that I have that implemented, all I have to do is include my header file anywhere I want to use this method. You can even do this in a global header file.</p>

<div><figure role=code> <div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
</pre></td><td class='code' width='100%'><pre><code class='objc'><div class='line'><span class="cp">#import &quot;NSString+FLUXAdditions.h&quot;</span>
</div></code></pre></td></tr></table></div></figure></div>




<div><figure role=code> <div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
</pre></td><td class='code' width='100%'><pre><code class='objc'><div class='line'><span class="p">[</span><span class="s">@&quot;My awesome string&quot;</span> <span class="nl">startsWith:</span><span class="s">@&quot;My&quot;</span><span class="p">];</span>  <span class="c1">//returns YES</span>
</div><div class='line'><span class="p">[</span><span class="s">@&quot;My awesome string&quot;</span> <span class="nl">startsWith:</span><span class="s">@&quot;Foo&quot;</span><span class="p">];</span> <span class="c1">//returns NO;</span>
</div></code></pre></td></tr></table></div></figure></div>


<p>So now that we understand how categories work, how can we utilize this to solve our original problem?</p>

<h2>Private Categories</h2>


<p>We can utilize private categories to give us the benefit of properties for our ivars, but at the same time, NOT expose those to the outside world. Here&#8217;s how it works (using our example from above):</p>

<p><em>MyTableViewController.m</em></p>

<div><figure role=code> <div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
<span class='line'>3</span>
</pre></td><td class='code' width='100%'><pre><code class='objc'><div class='line'><span class="k">@interface</span> <span class="nc">MyTableViewController</span> <span class="p">()</span>
</div><div class='line'><span class="k">@property</span> <span class="p">(</span><span class="n">nonatomic</span><span class="p">,</span> <span class="n">retain</span><span class="p">)</span> <span class="n">NSArray</span> <span class="o">*</span><span class="n">items</span><span class="p">;</span>
</div><div class='line'><span class="k">@end@implementation</span> <span class="nc">MyTableViewController</span><span class="k">@synthesize</span> <span class="n">items</span><span class="p">;...</span><span class="k">@end</span>
</div></code></pre></td></tr></table></div></figure></div>


<p>Notice how we declared the category interface directly the implementation file. This works because the .m file will only be loaded once, and since it&#8217;s inside the .m file, no other classes will ever know it existed. We can remove the property declaration from the header file and everything should work the same.</p>

<p>Private categories can also be used to provide method declarations, which can help you order your methods in a way that makes sense, and not worry about the compiler complaining about methods that haven&#8217;t been declared yet.</p>

<h2>Private Category Gotcha</h2>


<p>One thing that tripped me up is the name of the private category. When first doing this I originally chose the name &#8220;Private&#8221;. But there&#8217;s something peculiar about named category methods versus unnamed ones (like I have above).</p>

<p>Unfortunately Xcode4 wasn&#8217;t very smart about telling me what was wrong, instead giving me conflicting error messages:</p>

<p><a href="http://flux88.com/wp-content/uploads/2011/04/xcode4-private-category-error.png"><img src="/images/xcode4-private-category-error-tm.jpg"  height="124"  /></a></p>

<p>This <a href="http://stackoverflow.com/questions/1052233/iphone-obj-c-anonymous-category-or-private-category/1055213#1055213" target="_blank">stack overflow answer</a> helped explain the difference between the two styles.</p>

<p>Hopefully this helped you understand how to leverage categories to clean up your public APIs!</p>
</div>
  <footer>
    <a rel="full-article" href="/2011/04/private-categories-in-objective-c/">Read on &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/2011/04/increasing-shared-memory-for-postgres-on-os-x/">Increasing Shared Memory for Postgres on OS X</a></h1>
    
    
      <p class="meta">




<time datetime="2011-04-14 00:00:00 -0500" pubdate  updated >Apr 14<span>th</span>, 2011</time>


</p>
    
  </header>


  <div class="entry-content"><p>I came across a cryptic error while trying to create another database instance for my local Postgresql server. The error was:</p>


<blockquote>
  
<div><figure role=code><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
<span class='line'>3</span>
<span class='line'>4</span>
<span class='line'>5</span>
<span class='line'>6</span>
<span class='line'>7</span>
</pre></td><td class='code' width='100%'><pre><code class=''><div class='line'>creating template1 database in data/base/1 ...
</div><div class='line'>FATAL: could not create shared memory segment: Cannot allocate memory
</div><div class='line'>DETAIL: Failed system call was shmget(key=1, size=1318912, 03600).
</div><div class='line'>HINT: This error usually means that PostgreSQL's request for a shared&lt;br />memory segment exceeded available memory or swap space. To reduce the &lt;br />request size (currently 1318912 bytes), reduce PostgreSQL's shared_buffers &lt;br />parameter (currently 50) and/or its max_connections parameter (currently 10).
</div><div class='line'>The PostgreSQL documentation contains more information about shared memory &lt;br />configuration.
</div><div class='line'>child process exited with exit code 1
</div><div class='line'>initdb: removing contents of data directory "data"</div></code></pre></td></tr></table></div></figure></div>

</blockquote>


<p>The issue is that your Mac is not configured for &#8220;server&#8221; level resource usage. In order to check what your kernel settings are for shared memory, type:</p>




<div><figure role=code><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
</pre></td><td class='code' width='100%'><pre><code class=''><div class='line'>sysctl -a</div></code></pre></td></tr></table></div></figure></div>




<p>Look for keys that start with `kern.sysv.sh____`. Note that the numbers are somewhat related, so you have to change them together. Some helpful detail was found on <a href="http://support.bitrock.com/article/postgresql-cannot-allocate-memory-on-mac-os-x" target="_blank">this post</a>:</p>


<blockquote>
  Note that (kern.sysv.shmall * 4096) should be greater than or equal to kern.sysv.shmmax. kern.sysv.shmmax must also be a multiple of 4096.
</blockquote>


<p>You can set these values temporarily with `sysctl -w [keyname] [value]`, but to make them permanent, you can write the values to `/etc/sysctl.conf`. Here are the values I used:</p>




<div><figure role=code><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
<span class='line'>3</span>
<span class='line'>4</span>
<span class='line'>5</span>
<span class='line'>6</span>
<span class='line'>7</span>
</pre></td><td class='code' width='100%'><pre><code class=''><div class='line'>kern.sysv.shmmax=1610612736
</div><div class='line'>kern.sysv.shmall=393216
</div><div class='line'>kern.sysv.shmmin=1
</div><div class='line'>kern.sysv.shmmni=32
</div><div class='line'>kern.sysv.shmseg=8
</div><div class='line'>kern.maxprocperuid=512
</div><div class='line'>kern.maxproc=2048</div></code></pre></td></tr></table></div></figure></div>




<p>You&#8217;ll need to reboot, but once you&#8217;re back up you should be able to create more Postgres databases with ease.<br /></p>

</div>
  <footer>
    <a rel="full-article" href="/2011/04/increasing-shared-memory-for-postgres-on-os-x/">Read on &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/2011/04/presentations-from-iphone-dev-con-boston/">Presentations From iPhone Dev Con Boston</a></h1>
    
    
      <p class="meta">




<time datetime="2011-04-13 00:00:00 -0500" pubdate  updated >Apr 13<span>th</span>, 2011</time>


</p>
    
  </header>


  <div class="entry-content"><p>I gave 2 talks at iPhone Dev Con in Boston. I&#8217;ve posted the slides &amp; material online.</p>


<h2>Effective iOS Network Programming Techniques</h2>


<div style="width:425px" id="__ss_7615089">
  <strong style="display:block;margin:12px 0 4px"><a href="http://www.slideshare.net/subdigital/effective-ios-network-programming-techniques" title="Effective iOS Network Programming Techniques">Effective iOS Network Programming Techniques</a></strong> <iframe src="http://www.slideshare.net/slideshow/embed_code/7615089" width="425" height="355" frameborder="0" marginwidth="0" marginheight="0" scrolling="no"></iframe>

  <div style="padding:5px 0 12px">
    View more <a href="http://www.slideshare.net/">presentations</a> from <a href="http://www.slideshare.net/subdigital">subdigital</a>
  </div>
</div>


<h2>Objective-C &amp; iPhone for .NET Developers</h2>


<div style="width:425px" id="__ss_7615068">
  <strong style="display:block;margin:12px 0 4px"><a href="http://www.slideshare.net/subdigital/objectivec-iphone-for-net-developers" title="Objective-C &amp; iPhone for .NET Developers">Objective-C &amp; iPhone for .NET Developers</a></strong> <iframe src="http://www.slideshare.net/slideshow/embed_code/7615068" width="425" height="355" frameborder="0" marginwidth="0" marginheight="0" scrolling="no"></iframe>

  <div style="padding:5px 0 12px">
    View more <a href="http://www.slideshare.net/">presentations</a> from <a href="http://www.slideshare.net/subdigital">subdigital</a>
  </div>
</div>


<p>Demo code &amp; slides for both sessions <a href="https://github.com/subdigital/iphonedevcon-boston">can be found on github</a>.</p>


<p>Thanks to all who attended and left me such great reviews!</p>

</div>
  <footer>
    <a rel="full-article" href="/2011/04/presentations-from-iphone-dev-con-boston/">Read on &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/2011/04/book-review-crafting-rails-applications/">Book Review: Crafting Rails Applications</a></h1>
    
    
      <p class="meta">




<time datetime="2011-04-13 00:00:00 -0500" pubdate  updated >Apr 13<span>th</span>, 2011</time>


</p>
    
  </header>


  <div class="entry-content"><p><img src="/images/capa_crafting.png"  style="float:left; margin-right:10px; margin-bottom:10px;"  /></p>

<p>I just finished with <a href="http://www.amazon.com/gp/product/1934356735/ref=as_li_ss_tl?ie=UTF8&amp;tag=flux88com-20&amp;linkCode=as2&amp;camp=1789&amp;creative=390957&amp;creativeASIN=1934356735">Crafting Rails Applications</a><img src="http://www.assoc-amazon.com/e/ir?t=&amp;l=as2&amp;o=1&amp;a=1934356735" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /> by <a href="http://blog.plataformatec.com.br/author/josevalim/">José Valim</a>. The book claims to teach Expert Practices for Everyday Rails Development. I didn&#8217;t find it to be exactly that, however I did enjoy it and I learned a ton.</p>


<h2>The Good</h2>


<p>The book flows pretty well. Each chapter contains a challenge or set of related challenges and it&#8217;s pretty easy to follow along with the code. Each example contains automated tests, and he creates a gem for almost each solution, so that it is easy to see how to modularize things.<br />
The coverage of Rails internals is really enlightening. Sometimes it can be a bit dry, but you&#8217;ll learn quite a few things about Renderers, Responders, Engines, Railties, Routing, Rack, Instruments, and more.<br />
The book also contains a wide range of technology topics. José doesn&#8217;t just utilize Rails &amp; ActiveRecord. Other examples include MongoMapper, Redis, and Sinatra.<br /></p>

<h2>The Bad</h2>


<p>Even though each of the examples contains unit tests, they are written in a style that I find to be problematic in real systems. The concise nature of the tests is probably an artifact of being printed, but most of the testing examples utilize few test classes with many assertions per test method.<br />
In addition, though he &#8220;writes&#8221; the tests before implementation, this actually hurts understandability in some cases. The reason is most of the tests read as if he already knew the implementation and knew exactly how to test it. But it isn&#8217;t apparent to the reader.<br />
I tend to prefer RSpec with 1 assertion per test method and many fine-grained methods that test various behaviors in each context my system is in. The book&#8217;s Test::Unit style wasn&#8217;t something I&#8217;d suggest as a good way to test real applications.<br /></p>

<h2>The Bottom Line</h2>


<p>Ultimately I think the book is excellent, and certainly gives plenty of information about Rails 3 internals. I think newcomers would probably be lost, but if you&#8217;re past the newbie stage with Rails then this book is recommended.<br /></p>

<br />

</div>
  <footer>
    <a rel="full-article" href="/2011/04/book-review-crafting-rails-applications/">Read on &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/2011/04/mariachi-product-engineering/">Mariachi Product Engineering</a></h1>
    
    
      <p class="meta">




<time datetime="2011-04-12 00:00:00 -0500" pubdate  updated >Apr 12<span>th</span>, 2011</time>


</p>
    
  </header>


  <div class="entry-content"><p>I spoke at iPhone Dev Con in Boston last week and I attended Mike Lee&#8217;s excellent keynote presentation: &#8220;Mariachi Product Engineering&#8221;</p>


<p>At iPhone Dev Con in San Diego last year, Mike came out dressed like a Pirate. No kidding.</p>


<p><br />
<img src="/images/mikelee-pirate.jpg"  alt="mikelee-pirate"  /></p>


<p>This year he came with a Mariachi outfit on. It&#8217;s pretty hilarious as nobody expects a keynote speaker to be dressed this way.</p>


<p>Over beers some of the guys at the conference decided it would be awesomely-epic to hire a real mariachi band to play during his keynote. So how does one find a mariachi band with after midnight on a Monday? Apparently, AMEX. One of the guys called his AMEX service and they <i>delivered</i>. I swear this could be the makings of a new AMEX commercial.</p>


<p>It made for a memorable keynote to say the least. The talk was excellent as well, as Mike certainly has a lot to say about Product Engineering.</p>


<p>Here is the video of the first 30 or so minutes of the talk (I ran out of battery before it was over).</p>


<iframe src="http://player.vimeo.com/video/22031658" width="400" height="300" frameborder="0"></iframe>


<p><a href="http://vimeo.com/22031658">Mike Lee - Mariachi Product Engineering</a> from <a href="http://vimeo.com/user1579700">Ben Scheirman</a> on <a href="http://vimeo.com">Vimeo</a>.</p>


<p><img src="/images/mikelee-mariachi.jpg"  alt="mikelee-mariachi.jpg"  /></p>


<p>I&#8217;ll have links to my presentation material soon, but I wanted to share this awesome event. Certainly one for the books!</p>

</div>
  <footer>
    <a rel="full-article" href="/2011/04/mariachi-product-engineering/">Read on &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/2011/04/blog-reboot/">[Blog Reboot]</a></h1>
    
    
      <p class="meta">




<time datetime="2011-04-11 00:00:00 -0500" pubdate  updated >Apr 11<span>th</span>, 2011</time>


</p>
    
  </header>


  <div class="entry-content"><p>My blog was feeling a little stale to me, hence my utter lack of content in the past few months.  I wanted to move it off of Windows hosting which really didn&#8217;t make sense for me anymore.  Orcsweb graciously provided me with hosting through my MVP, and I would recommend their service to anyone.</p>

<p>But for me, it doesn&#8217;t make sense to run a .NET blog anymore.  The days of &#8220;oh, maybe I&#8217;ll be able to extend it somehow&#8221; have just not ever mattered much.  In the end, it was a pretty easy decision to move to Wordpress because it&#8217;s easy to host, easy to extend, there&#8217;s a gajillion themes &amp; plugins, and the entire thing is fairly polished.  Sure, there&#8217;s the nasty PHP underneath, but hey it lends itself well to simple hacking of the site to get things up &amp; running.</p>

<p>So this is my attempt to freshen things up &amp; encourage me to start posting more.  Let me know what you think!</p>

<p><em>Side note: My blog has now had a total of 4 homes.  First was blogger, then dasBlog, over to GraffitiCMS, and now finally WordPress.</em></p>
</div>
  <footer>
    <a rel="full-article" href="/2011/04/blog-reboot/">Read on &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/2011/01/connecting-to-sql-server-2008-from-ruby-on-linux/">Connecting to SQL Server 2008 From Ruby on Linux</a></h1>
    
    
      <p class="meta">




<time datetime="2011-01-20 00:00:00 -0600" pubdate  updated >Jan 20<span>th</span>, 2011</time>


</p>
    
  </header>


  <div class="entry-content"><p>This is way hard than it should be, but once you go &#8220;off the rails&#8221; not everything is candy &amp; roses and chocolate covered bunnies. Of course, there is still a great community of talented folks producing stuff that makes all of this work.</p>


<p>The trick is to know what to look for. This post is for you, dear reader, to hopefully avoid all of the trial and error that I went through and hopefully get it to just work.</p>


<p>So, in my quest to connect a little ruby app on Linux to a SQL Server 2008 instance on Windows, I stumbled across the magical combination that allowed me to perform this task.<br /></p>


<p>All of these commands were run on Ubuntu 10.4.</p>


<h2>Step 1: Get unixODBC.</h2>


<p>You&#8217;ll be connecting via ODBC, so let&#8217;s grab this one. There&#8217;s also iODBC, but I didn&#8217;t give that one a try.<br /></p>




<div><figure role=code><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
</pre></td><td class='code' width='100%'><pre><code class=''><div class='line'>sudo apt-get install unixodbc-dev</div></code></pre></td></tr></table></div></figure></div>




<h2>Step 2: Get FreeTDS</h2>


<p>TDS stands for &#8220;Table Data Stream&#8221; and is the communication protocol that Sybase &amp; SQL Server use. There are plenty of commercial drivers out there for just about every operating system, but one stood out to me&#8230; <a href="http://freetds.org/">FreeTDS</a>. I&#8217;ll give you 3 guesses why I liked this one (but you&#8217;ll only need 1).<br /></p>


<p>We&#8217;ll also need the ODBC connector for this.</p>


<p>
<div><figure role=code><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
</pre></td><td class='code' width='100%'><pre><code class=''><div class='line'>sudo apt-get install freetds tdsodbc</div></code></pre></td></tr></table></div></figure></div>
</p>


<h2>Step 3: Configure-shit</h2>


<p>There are 3 INI files that we need to modify. When I did this on my Mac, they were in /usr/local/etc, but on Ubuntu it was all in the /etc directory.<br /></p>


<p>Confirm that the FreeDTS &amp; TDSODBC drivers are in place by looking in `/usr/lib/odbc` for the files `libtdsodbc.so` and `libtdsS.so`. We&#8217;ll be using those in the next step.</p>


<p>Using your favorite editor, open up `/etc/odbcinst.ini`. This file might not exist yet, that&#8217;s okay.</p>




<div><figure role=code><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
</pre></td><td class='code' width='100%'><pre><code class=''><div class='line'>sudo vim /etc/odbcinst.ini</div></code></pre></td></tr></table></div></figure></div>


<br />


<p>Here&#8217;s where we tell unixODBC which ODBC drivers the system supports. We&#8217;ll add the following text:</p>




<div><figure role=code><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
<span class='line'>3</span>
<span class='line'>4</span>
<span class='line'>5</span>
<span class='line'>6</span>
<span class='line'>7</span>
</pre></td><td class='code' width='100%'><pre><code class=''><div class='line'>[FreeTDS]
</div><div class='line'>Description = FreeTDS Driver
</div><div class='line'>Driver = /usr/lib/odbc/libtdsodbc.so
</div><div class='line'>Setup = /usr/lib/odbc/libtdsS.so
</div><div class='line'>FileUsage = 1
</div><div class='line'>CPTimeout = 5
</div><div class='line'>CPReuse = 5</div></code></pre></td></tr></table></div></figure></div>


<br />


<p>Save that file. Next up we should configure FreeTDS to define our data sources.<br /></p>




<div><figure role=code><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
</pre></td><td class='code' width='100%'><pre><code class=''><div class='line'>sudo vim /etc/odbc/freetds/freetds.conf</div></code></pre></td></tr></table></div></figure></div>


<br />


<p>There should be some example configurations in here. Also note that here is where you can un-comment a line to enable debug output if you&#8217;re having trouble (I needed this). Here is my configuration:</p>




<div><figure role=code><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
<span class='line'>3</span>
<span class='line'>4</span>
<span class='line'>5</span>
</pre></td><td class='code' width='100%'><pre><code class=''><div class='line'>#my sql server (SQL Server 2008)
</div><div class='line'>[my_database]
</div><div class='line'>host = 11.22.33.44 #no this isn't a real IP. you think I'm crazy?
</div><div class='line'>port = 1433 #change this if you're running your db on a non-standard port
</div><div class='line'>tds version = 8.0</div></code></pre></td></tr></table></div></figure></div>




<p>One last piece of configuration is needed. This is the general system datasources configuration.<br /></p>




<div><figure role=code><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
</pre></td><td class='code' width='100%'><pre><code class=''><div class='line'>sudo vim /etc/odbc.ini</div></code></pre></td></tr></table></div></figure></div>


<p>The following should be fairly obvious configuration:<br /></p>

<div><figure role=code><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
<span class='line'>3</span>
<span class='line'>4</span>
</pre></td><td class='code' width='100%'><pre><code class=''><div class='line'>[my_database] #note this doesn't have to match what's in freetds.conf
</div><div class='line'>Servername = my_database #this matches what's in freetds.conf
</div><div class='line'>Driver = FreeTDS #this matches the driver you configured in odbcinst.ini
</div><div class='line'>Database = YOUR_DATABASE_HERE</div></code></pre></td></tr></table></div></figure></div>




<h2>Step 4: Try it out</h2>


<br />


<p>Using the unixODBC tool, test out your connection:<br /></p>

<div><figure role=code><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
</pre></td><td class='code' width='100%'><pre><code class=''><div class='line'>isql my_database uid password</div></code></pre></td></tr></table></div></figure></div>


<p>If you had any errors, you&#8217;ll get something like &#8220;Cannot SQLConnect&#8221;. If this happens, check your debug log (if you enabled it in freetds.conf). In my case I forgot to enable Mixed Mode authentication on the SQL Server side.<br /></p>

<br />


<h2>Step 5: Install the gem</h2>


<br />


<p>We&#8217;ll be using a nice gem called <a href="https://github.com/rails-sqlserver/tiny_tds">tiny_tds</a>.<br /></p>

<div><figure role=code><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
</pre></td><td class='code' width='100%'><pre><code class=''><div class='line'>gem install tiny_tds</div></code></pre></td></tr></table></div></figure></div>


<p>With that installed, let&#8217;s test it out!<br />
Launch <code>irb</code>:<br /></p>

<div><figure role=code><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
<span class='line'>3</span>
<span class='line'>4</span>
</pre></td><td class='code' width='100%'><pre><code class=''><div class='line'>require 'tiny_tds'
</div><div class='line'>client = TinyTds::Client.new(:dataserver =&gt; 'my_database', :username=&gt;'user', :password=&gt;'password')
</div><div class='line'>client.closed? # should be false, if it's true you probably had an error connecting
</div><div class='line'>client.execute("SELECT getdate()").each {|row| puts row}</div></code></pre></td></tr></table></div></figure></div>




<p>If you got a date back, then your connection is working properly. <strong>Huzzah</strong>!</p>

</div>
  <footer>
    <a rel="full-article" href="/2011/01/connecting-to-sql-server-2008-from-ruby-on-linux/">Read on &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/2010/11/setting-up-a-new-linode-box-creating-user-accounts/">Setting Up a New Linode Box - Creating User Accounts</a></h1>
    
    
      <p class="meta">




<time datetime="2010-11-30 00:00:00 -0600" pubdate  updated >Nov 30<span>th</span>, 2010</time>


</p>
    
  </header>


  <div class="entry-content"><p>I&#8217;m setting up a new <a href="http://linode.com">Linode</a> box for a client. (Speaking of Linode, it&#8217;s freaking awesome and you should sign up. If you do, use this <a href="http://www.linode.com/?r=5054fa2264e88490f408a80da62eea5d5d99ee6a">link to give me some bonus credit</a>).</p>


<p>For the Linux distro I chose Ubuntu 10.4 (32-bit). This is just the one I know the best.</p>


<p>One of the first things I like to do is set up a personal user account so that I don&#8217;t use the root. This is so less-than-intuitive I have to look it up every time.</p>


<p>Here are my notes so that I don&#8217;t forget.</p>


<blockquote>
<p><span style="font-family: Arial; font-size: medium;">As root, run the useradd command:</span></p>
<div style="font-family: Arial; font-size: medium;">
<br />
</div>
<div style="font-family: Arial; font-size: medium;">
<font face="'Andale Mono'"><b>sudo useradd -d /home/testuser -m -s /bin/bash testuser</b></font>
</div>
<div style="font-family: Arial; font-size: medium;">
<br />
</div>
<div style="font-family: Arial; font-size: medium;">
Reset their password:
</div>
<div style="font-family: Arial; font-size: medium;">
<br />
</div>
<div style="font-family: Arial; font-size: medium;">
<font face="'Andale Mono'"><b>sudo passwd testuser</b></font>
</div>
<div style="font-family: Arial; font-size: medium;">
<br />
</div>
<div style="font-family: Arial; font-size: medium;">
Then add them to the sudoers file:
</div>
<div style="font-family: Arial; font-size: medium;">
<br />
</div>
<div style="font-family: Arial; font-size: medium;">
<font face="'Andale Mono'"><b>visudo</b></font>
</div>
<div style="font-family: Arial; font-size: medium;">
<br />
</div>
<div style="font-family: Arial; font-size: medium;">
Create a user alias for the company accounts:
</div>
<div style="font-family: Arial; font-size: medium;">
<br />
</div>
<div style="font-family: Arial; font-size: medium;">
<font face="'Andale Mono'"><b>User_Alias CHAIONE = user1, user2</b></font>
</div>
<div style="font-family: Arial; font-size: medium;">
<br />
</div>
<div style="font-family: Arial; font-size: medium;">
Then add this line lower down:
</div>
<div style="font-family: Arial; font-size: medium;">
<br />
</div>
<div style="font-family: Arial; font-size: medium;">
<font face="'Andale Mono'"><b>CHAIONE ALL=ALL</b></font>
</div>
<div style="font-family: Arial; font-size: medium;">
<br />
</div>
<div style="font-family: Arial; font-size: medium;">
For future users, just add them to the CHAIONE alias
</div>
</blockquote>

</div>
  <footer>
    <a rel="full-article" href="/2010/11/setting-up-a-new-linode-box-creating-user-accounts/">Read on &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/2010/11/incorporating-3rd-party-libraries-in-iphone-apps/">Incorporating 3rd Party Libraries in iPhone Apps</a></h1>
    
    
      <p class="meta">




<time datetime="2010-11-02 00:00:00 -0500" pubdate  updated >Nov 2<span>nd</span>, 2010</time>


</p>
    
  </header>


  <div class="entry-content"><p>Having my hands in .NET, Rails, and iPhone for the past year I&#8217;ve come to appreciate and loathe the various ways that projects incorporate code from 3rd parties.</p>


<p>Objective-C &amp; Xcode get the award for the least-awesome way of reusing libraries. I&#8217;ll cut them a tiny bit of slack since this technology is decades old, however it&#8217;s 2010 and I have work to do. Let&#8217;s just say there&#8217;s no &#8220;iPhoneGems&#8221; project and many projects (such as the excellent <a href="http://allseeing-i.com/ASIHTTPRequest/">ASIHTTPRequest</a>) simply suggest copying over source files into your project. This sucks for a number of reasons, but at the core it&#8217;s simply copy-paste code reuse.</p>


<h2>No Dynamic Linking</h2>


<p>The reason is mostly because there is no dynamic linking on the iPhone. You can&#8217;t simply &#8220;reference a dll&#8221; and have it work. You are limited to static linking, however that means that you need to pre-compile for each SDK version &amp; architecture. Not fun, nor do I even completely understand how all this works. This is how I originally used the <a href="http://code.google.com/p/json-framework/">JSON-Framework</a>, however I&#8217;ve since relegated to copying over source files into my project, after realizing that they hadn&#8217;t updated their static library for the 4.0 SDK.<br /></p>


<h2>What do the big boys do?</h2>


<p>As a larger example, <a href="http://github.com/facebook/three20">Facebook&#8217;s Three20 project</a> itself has many projects, and utilizes Xcode&#8217;s project dependencies. The setup is slightly more involved as you need to setup Header Search Paths, Linker Flags, and other (seemingly arcane) configurations, but if you follow the directions it is not too terrible.<br /></p>


<p>This method sets up project dependencies, where the output of the sub-projects (in this case the suite of Three20&#8217;s projects) are static libraries for the SDK &amp; Architecture you&#8217;ve specified for your project.</p>


<p>This is a pain to setup initially but does offer some additional benefits, such as having the other projects remain in a separate source tree. In our case, we&#8217;re pulling in Three20 from a git repository, and we are leveraging git submodules to make this happen. (Though git submodules are a bit of a pain to deal with).</p>


<h2>What do you do?</h2>


<p>Do you utilize this technique for your internal shared code? Or do you resort to copying around source files from project to project?</p>

</div>
  <footer>
    <a rel="full-article" href="/2010/11/incorporating-3rd-party-libraries-in-iphone-apps/">Read on &rarr;</a>
  </footer>


  </article>

<nav role="pagination">
  <div>
    
      <a class="prev" href="/blog/page/4/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/2/">Newer &rarr;</a>
    
  </div>
</nav>

<script type="text/javascript">
    var disqus_shortname = 'subdigital';
    (function () {
      var s = document.createElement('script'); s.async = true;
      s.type = 'text/javascript';
      s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
      (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>

</div>
<aside role=sidebar>
  
    <section>
  <h1>Who am I?</h1>
  <p>I&#8217;m Ben Scheirman. I make Rails &amp; iPhone apps for <a href="http://chaione.com" target="_blank">ChaiONE</a> in Houston, TX.</p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2011/10/houston-tech-fest-2011-recap/">Houston Tech Fest 2011 Recap</a>
      </li>
    
      <li class="post">
        <a href="/2011/10/appsites-is-now-appkickstand/">Appsites Is Now AppKickstand</a>
      </li>
    
      <li class="post">
        <a href="/2011/10/sharing-vim-configuration-between-machines/">Sharing Vim Configuration Between Machines</a>
      </li>
    
      <li class="post">
        <a href="/2011/10/making-a-uibutton-flip-over/">Making a UIButton Flip Over</a>
      </li>
    
      <li class="post">
        <a href="/2011/09/creating-a-glow-effect-for-uilabel-and-uibutton/">Creating a Glow Effect for UILabel and UIButton</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("subdigital", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/subdigital" class="twitter-follow-button" data-width="208px" data-show-count="false">Follow @subdigital</a>
  
</section>


<section>
  <h1>On Delicious</h1>
  <script type="text/javascript" src="http://feeds.delicious.com/v2/js/subdigital?title=&count=3&sort=date&extended"></script>
  <p><a href="http://delicious.com/subdigital">My Delicious Bookmarks &raquo;</a></p>
</section>



  
</aside>

    </div>
  </div>
  <footer>
<a style="display:block; float: right" title="Real Time Analytics" href="http://getclicky.com/66470389"><img alt="Real Time Analytics" src="//static.getclicky.com/media/links/badge.gif" border="0" /></a>
<script src="//static.getclicky.com/js" type="text/javascript"></script>
<script type="text/javascript">try{ clicky.init(66470389); }catch(e){}</script>
<noscript><p><img alt="Clicky" width="1" height="1" src="//in.getclicky.com/66470389ns.gif" /></p></noscript>

<p>
  Copyright &copy; 2011 - Ben Scheirman -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
</body>
</html>
